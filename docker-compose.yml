services:
  sandkasten:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: sandkasten
    restart: unless-stopped

    # Required for namespace/cgroup/overlayfs operations
    privileged: true
    cgroup: host

    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:rw
      - /var/lib/sandkasten:/var/lib/sandkasten
      - ./sandkasten.yaml:/etc/sandkasten/sandkasten.yaml:ro

    environment:
      SANDKASTEN_API_KEY: sk-test

    command: ["/bin/sandkasten", "--config", "/etc/sandkasten/sandkasten.yaml"]
    ports:
      - "8080:8080"
