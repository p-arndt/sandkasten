services:
  sandkasten:
    build:
      context: .
      dockerfile: Dockerfile.daemon
    ports:
      - "8080:8080"
    volumes:
      # Mount Docker socket so daemon can manage containers
      - /var/run/docker.sock:/var/run/docker.sock
      # Persist SQLite database
      - ./data:/data
    environment:
      SANDKASTEN_LISTEN: "0.0.0.0:8080"
      SANDKASTEN_DB_PATH: "/data/sandkasten.db"
      SANDKASTEN_API_KEY: "${SANDKASTEN_API_KEY:-sk-sandbox-dev}"
      SANDKASTEN_SESSION_TTL_SECONDS: "1800"
    restart: unless-stopped
    networks:
      - sandkasten

networks:
  sandkasten:
    driver: bridge
